{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixarbay-api.js","../src/main.js"],"sourcesContent":["export function createGalleryMarkup(array) {\n  return array\n    .map(\n      image =>\n        `<li class=\"gallery-item\">\n          <a href=\"${image.largeImageURL}\" alt=\"${image.tags}\">\n              <img src=\"${image.webformatURL}\" >\n          </a>\n              <div>\n              <table>\n                  <thead>\n                      <tr>\n                          <th>Likes</th>\n                          <th>Views</th>\n                          <th>Comments</th>\n                          <th>Downloads</th>\n                      </tr>\n                  </thead>\n                  <tbody>\n                      <tr>\n                          <td>${image.likes}</td>\n                          <td>${image.views}</td>\n                          <td>${image.comments}</td>\n                          <td>${image.downloads}</td>\n                      </tr>\n                  </tbody>\n                  </table>\n              </div>\n         </li>`\n    )\n    .join('');\n}\n","import axios from 'axios';\n\nconst API_KEY = '43362047-b69de0f8b7d88fd6ec05c5589';\naxios.defaults.baseURL = 'https://pixabay.com/';\n\nexport async function getPhotos(q, page) {\n  try {\n    const searchParams = {\n      params: {\n        key: API_KEY,\n        q,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: 15,\n      },\n    };\n    const { data } = await axios.get(`api/`, searchParams);\n    return data;\n  } catch (err) {\n    console.log(err);\n  }\n}\n\n// export function getPhotos(q, page) {\n//   const API_KEY = '43362047-b69de0f8b7d88fd6ec05c5589';\n//   const baseUrl = 'https://pixabay.com/api';\n\n//   const params = new URLSearchParams({\n//     key: API_KEY,\n//     q,\n//     image_type: 'photo',\n//     orientation: 'horizontal',\n//     safesearch: true,\n//     page,\n//     per_page: 15,\n//   });\n\n//   return fetch(`${baseUrl}/?${params}`).then(res => {\n//     if (!res.ok) {\n//       throw new Error(res.status);\n//       //   if(res)\n//     }\n//     return res.json();\n//   });\n// }\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { createGalleryMarkup } from './js/render-functions';\nimport { getPhotos } from './js/pixarbay-api';\n\nconst formElement = document.querySelector('[name=\"search\"]');\nconst inputElement = document.querySelector('input');\nconst galleryArea = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nlet lightbox = new SimpleLightbox('.gallery a');\nconst btnLoadMore = document.querySelector('.js-button-load');\nlet searchQuery = null;\nlet page = 1;\n\nformElement.addEventListener('submit', onSubmit);\nbtnLoadMore.addEventListener('click', loadedMoreImages);\n\nasync function onSubmit(event) {\n  event.preventDefault();\n\n  searchQuery = event.currentTarget.elements.search.value.trim();\n  showLoader();\n  btnLoadMore.classList.add('is-hidden');\n  galleryArea.innerHTML = '';\n  page = 1;\n\n  if (!searchQuery) return;\n\n  try {\n    const { hits, totalHits } = await getPhotos(searchQuery, page);\n    if (totalHits > 0) {\n      iziToast.info({\n        position: 'topRight',\n        message: `We found ${totalHits} images`,\n        maxWidth: '432',\n      });\n    }\n    if (hits.length === 0) {\n      return iziToast.error({\n        position: 'topRight',\n\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        maxWidth: '432',\n        messageColor: '#fafafb',\n        color: '#ef4040',\n      });\n    }\n\n    galleryArea.innerHTML = createGalleryMarkup(hits);\n\n    lightbox.refresh();\n\n    if (totalHits > 15) {\n      btnLoadMore.classList.remove('is-hidden');\n    }\n\n    inputElement.value = '';\n  } catch (error) {\n    console.log(error);\n\n    if (error.response === 401) {\n      iziToast.error({\n        position: 'topRight',\n        message: `You not authorization`,\n      });\n    }\n    if (error.response.status === 404) {\n      iziToast.error({\n        position: 'topRight',\n        message: `Bad request, please try again `,\n      });\n    }\n    if (error.response.status === 500) {\n      iziToast.error({\n        position: 'topRight',\n        message: `Server error`,\n      });\n    }\n  } finally {\n    hiddeLoader();\n  }\n}\n\nasync function loadedMoreImages() {\n  page += 1;\n\n  try {\n    const { hits, totalHits } = await getPhotos(searchQuery, page);\n    galleryArea.insertAdjacentHTML('beforeend', createGalleryMarkup(hits));\n    lightbox.refresh();\n\n    const { height: cardHeight } = document.querySelector('.gallery').firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    const lastPage = Math.ceil(totalHits / 15);\n\n    if (lastPage === page) {\n      btnLoadMore.classList.add('is-hidden');\n\n      iziToast.info({\n        position: 'topRight',\n        message: `We're sorry, but you've reached the end of search results`,\n        maxWidth: '432',\n      });\n    }\n  } catch (error) {\n    console.log(error.response.status);\n  } finally {\n    hiddeLoader();\n  }\n}\n\nfunction showLoader() {\n  loader.classList.remove('is-hidden');\n}\n\nfunction hiddeLoader() {\n  loader.classList.add('is-hidden');\n}\n"],"names":["createGalleryMarkup","array","image","API_KEY","axios","getPhotos","q","page","searchParams","data","err","formElement","inputElement","galleryArea","loader","lightbox","SimpleLightbox","btnLoadMore","searchQuery","onSubmit","loadedMoreImages","event","showLoader","hits","totalHits","iziToast","error","hiddeLoader","cardHeight"],"mappings":"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"}